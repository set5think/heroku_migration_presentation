<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>A Reflection On Progress</title>
<!-- metadata -->
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.1" />
<meta name="presdate" content="March 12, 2013" />
<meta name="author" content="Hassan Shahid" />
<meta name="company" content="KaBOOM!" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<link rel="stylesheet" href="../assets/ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="../assets/ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="../assets/stylesheets/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="../assets/ui/default/opera.css" type="text/css" media="projection" id="operaFix" />
<link rel="stylesheet" href="../assets/stylesheets/pressie.css" type="text/css" />

<!-- S5 JS -->
<script src="../assets/ui/default/slides.js" type="text/javascript"></script>

<!-- Syntax Highlighter -->
<link rel="stylesheet"  href="../assets/dp.SyntaxHighlighter/Styles/SyntaxHighlighter.css"></link>

</head>
<body>

<div class="layout">
<div id="controls"><!-- DO NOT EDIT --></div>
<div id="currentSlide"><!-- DO NOT EDIT --></div>
<div id="header"></div>
<div id="footer">
<h2>Copyright Â© 2013 Hassan Shahid</h2>
</div>

</div>


<div class="presentation">
  
<div class="slide"><h1>A Reflection On Progress</h1>
<blockquote>
<p>Hassan Shahid</p>
</blockquote>
</div>
<div class="slide"><h1>Contents</h1>
<div style="font-size: 70%">
<ul>
	<li>Who am I?</li>
</ul>
<ul>
	<li>KaBOOM!?</li>
</ul>
<ul>
	<li>Using technology is easy.  Using any technology well is hard.</li>
</ul>
<ul>
	<li>Lessons Learned</li>
</ul>
<ul>
	<li>Summarize this shiz</li>
</ul>
</div>
</div>
<div class="title slide">
<h1>Who am I?</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ $ whoami
hassan
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/who_am_i.sh">code/who_am_i.sh</a></div></p>
</div>
<div class="title slide">
<h1>Who am I really?</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ $ whoamireally
Hassan Shahid
Director of Engineering at KaBOOM! for ~ 1 year
Likes: Perl, Ruby, Postgres, Javascript
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/who_am_i_really.sh">code/who_am_i_really.sh</a></div></p>
</div>
<div class="title slide">
<h1>KaBOOM!?</h1>
</div>
<div class="slide"><h1>About KaBOOM!</h1>
<ul>
	<li>National Non-Profit based in DC</li>
	<li>&#8220;A great place to play within walking distance of every child&#8221;</li>
	<li>~ 100 person staff</li>
	<li>Purple and Orange</li>
</ul>
</div>
<div class="slide"><h1>About KaBOOM!&#8217;s engineering department</h1>
<ul>
	<li>Six-person staff<br />
  &#8211; Three full-stack engineers<br />
  &#8211; Two front-end engineers<br />
  &#8211; One product manager</li>
	<li>Our core technologies to date<br />
  &#8211; Languages: Ruby, Rails, jQuery<br />
  &#8211; Relational DB: MySQL (previously), PostgreSQL (current)<br />
  &#8211; Organization/Product Management: Trello<br />
  &#8211; Other data stores/caching: Redis, Memcached, Sphinx (Previously)</li>
	<li>Mapping And <span class="caps">DIY</span></li>
	<li>Plenty of clutter/technical debt over the years</li>
</ul>
</div>
<div class="slide"><h1>You don&#8217;t believe me?</h1>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">def self.adjust_for_rating(rating, destroyed = false)
  updates = [
      "rating_average=(rating_total/rating_count)",
      "rating_total=rating_total + (%d)" % rating.rating
  ]

  ...

  connection.execute(
    sanitize_sql([
      "INSERT INTO #{table_name}
       (record_type,record_id,rating_type_id,rating_total,rating_count,rating_average)
       VALUES (?, ?, ?, ?, #{counter}, ?)
       ON DUPLICATE KEY UPDATE #{updates.reverse.join(',')}
      ",
      rating.record_type, rating.record_id, rating.rating_type_id, rating.rating, rating.rating
    ])
  )
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/wtf.rb">code/wtf.rb</a></div></p>
</div>
<div class="slide"><h1>The last few months&#8230;</h1>
<ul>
	<li>Recruit new team members</li>
	<li>Release a mobile-browser presentation layer of our mapping product</li>
	<li>Revamp and migrate our entire infrastructure/architecture</li>
</ul>
</div>
<div class="slide"><h1>Recruit new team members</h1>
<ul>
	<li>Time-consuming</li>
	<li>Exhausting</li>
	<li>You still have the same amount of work left to do</li>
	<li>Plus our domain-specific hurdles of recruiting</li>
</ul>
</div>
<div class="slide"><h1>Our recruiting process</h1>
<ul>
	<li>Our requirements<br />
  &#8211; Everyone on the team must pair with the candidate<br />
  &#8211; No one on the team should have valid reservations with the candidate<br />
  &#8211; We must lose as little productivity as humanly possible</li>
</ul>
<ul>
	<li>We use Trello to manage the entire hiring process</li>
</ul>
<ul>
	<li>One 45-minute phone call with me (&lt;= 45 minutes)</li>
	<li>One in-person session<br />
  &#8211; We play planning poker (&lt;= 30 minutes)<br />
  &#8211; We each spend 30 minutes pairing with the candidate on the selected tasks (== 30 minutes)<br />
  &#8211; We jot our comments after we pair (&lt;= 5 minutes)<br />
  &#8211; The candidate and I sit down and I get their thoughts on the day and answer any questions they have (&lt;= 30 minutes)<br />
  &#8211; Discuss and decide (&lt;= 20 minutes)</li>
</ul>
</div>
<div class="title slide">
<h1>Using technology is easy.  Using any technology well is hard.</h1>
</div>
<div class="slide"><h1>Our infrastructure (Pre-migration)</h1>
<ul>
	<li>Inconsistent</li>
	<li>Tightly-coupled</li>
	<li>Single points of failure, srsly</li>
	<li>Redundancy (the bad kind)</li>
	<li>Virtually no automation</li>
	<li>Sad database (MySQL)</li>
	<li>Complex setups</li>
</ul>
</div>
<div class="slide"><h1>Our infrastructure in imagery (Pre-migration)</h1>
<ul>
	<li>Check out the two images in the root directory of this presentation</li>
	<li>One represents our staging env, and one represents our production env</li>
</ul>
</div>
<div class="slide"><h1>Our wishlist/goals for a new infrastructure</h1>
<ul>
	<li>Move to Postgres</li>
	<li>Proper staging and production environments</li>
	<li>Spin up prototype environments on the fly</li>
	<li>Manage multiple versions of rubies/gems with ease</li>
	<li>Decouple. &#8217;nuff said</li>
	<li>Simplify</li>
	<li>Automation</li>
	<li>On-demand scaling</li>
	<li>Cost</li>
</ul>
</div>
<div class="slide"><h1>Heroku was an easy choice for us</h1>
<table style="width:100%; font-size: 24px">
<tr>
    <td></td>
    <td><strong>Rackspace</strong></td>
    <td><strong>Linode</strong></td>
    <td><strong>Heroku</strong></td>
</tr>
<tr>
    <td><strong>Postgres</strong></td>
    <td>yes, requires setup</td>
    <td>yes, requires setup</td>
    <td>yes</td>
</tr>
<tr>
    <td><strong>Multiple environments</strong></td>
    <td>requires more <span class="caps">VPS</span> and setup</td>
    <td>requires more <span class="caps">VPS</span> and setup</td>
    <td>Treated like another app</td>
</tr>
<tr>
    <td><strong>Version management</strong></td>
    <td><span class="caps">RVM</span></td>
    <td><span class="caps">RVM</span></td>
    <td>Gemfile</td>
</tr>
<tr>
    <td><strong>Decouple</strong></td>
    <td>yes, requires setup</td>
    <td>yes, requires setup</td>
    <td>a <span class="caps">HUGE</span> head start</td>
</tr>
<tr>
    <td><strong>Simplify</strong></td>
    <td>requires setup</td>
    <td>requires setup</td>
    <td>a <span class="caps">HUGE</span> head start</td>
</tr>
<tr>
    <td><strong>Automation</strong></td>
    <td>requires setup</td>
    <td>requires setup</td>
    <td>a <span class="caps">HUGE</span> head start</td>
</tr>
<tr>
    <td><strong>On-demand scaling</strong></td>
    <td>requires setup</td>
    <td>requires setup</td>
    <td>A <span class="caps">HUGE</span> head start</td>
</tr>
<tr>
    <td><strong>Cost</strong></td>
    <td>On the surface, 2nd cheapest</td>
    <td>On the surface, cheapest</td>
    <td>On the surface, most expensive</td>
</tr>
</table>
</div>
<div class="slide"><h1>Upfront Disadvantages</h1>
<ul>
	<li>Slightly less control of cost, overall can be more expensive</li>
	<li>Less administrative control (sudo? what&#8217;s that?)</li>
	<li>Read-Only filesystem (a few exceptions to this)</li>
</ul>
</div>
<div class="slide"><h1>What we migrated</h1>
<ul>
	<li>Six web applications</li>
	<li>Two APIs</li>
	<li>Database</li>
</ul>
</div>
<div class="title slide">
<h1>Creating multiple environments on Heroku</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ tag_api hassan$ heroku create --remote &lt;insert_name_here&gt;
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/new_environment.sh">code/new_environment.sh</a></div></p>
</div>
<div class="slide"><h1>Creating multiple environments on Heroku</h1>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ tag_api hassan$ heroku create --remote staging
new-host-4:~ tag_api hassan$ cat .git/config
[core]
  repositoryformatversion = 0
  filemode = true
  bare = false
  logallrefupdates = true
  ignorecase = true
[remote "origin"]
  fetch = +refs/heads/*:refs/remotes/origin/*
  url = git@github.com:kaboom-org/tag_api
[branch "master"]
  remote = origin
  merge = refs/heads/master
[remote "staging"]
  url = git@heroku.com:rocky-sea-8976.git
  fetch = +refs/heads/*:refs/remotes/staging/*
[gitflow "branch"]
  master = master
  develop = develop
[gitflow "prefix"]
  feature = feature/
  release = release/
  hotfix = hotfix/
  support = support/
  versiontag =
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/new_environment.sh">code/new_environment.sh</a></div></p>
</div>
<div class="slide"><h1>Creating multiple environments on Heroku (cont.)</h1>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ tag_api hassan$ heroku create --remote production
new-host-4:~ tag_api hassan$ cat .git/config
[core]
  repositoryformatversion = 0
  filemode = true
  bare = false
  logallrefupdates = true
  ignorecase = true
[remote "origin"]
  fetch = +refs/heads/*:refs/remotes/origin/*
  url = git@github.com:kaboom-org/tag_api
[branch "master"]
  remote = origin
  merge = refs/heads/master
[remote "staging"]
  url = git@heroku.com:rocky-sea-8976.git
  fetch = +refs/heads/*:refs/remotes/staging/*
[remote "production"]
  url = git@heroku.com:dead-wood-3875.git
  fetch = +refs/heads/*:refs/remotes/production/*
[gitflow "branch"]
  master = master
  develop = develop
[gitflow "prefix"]
  feature = feature/
  release = release/
  hotfix = hotfix/
  support = support/
  versiontag =
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/new_environment.sh">code/new_environment.sh</a></div></p>
</div>
<div class="slide"><h1>Creating multiple environments on Heroku (cont.)</h1>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ tag_api hassan$ git config heroku.remote staging
new-host-4:~ tag_api hassan$ cat .git/config
[core]
  repositoryformatversion = 0
  filemode = true
  bare = false
  logallrefupdates = true
  ignorecase = true
[remote "origin"]
  fetch = +refs/heads/*:refs/remotes/origin/*
  url = git@github.com:kaboom-org/tag_api
[branch "master"]
  remote = origin
  merge = refs/heads/master
[remote "staging"]
  url = git@heroku.com:rocky-sea-8976.git
  fetch = +refs/heads/*:refs/remotes/staging/*
[remote "production"]
  url = git@heroku.com:dead-wood-3875.git
  fetch = +refs/heads/*:refs/remotes/production/*
[heroku]
  remote = staging
[gitflow "branch"]
  master = master
  develop = develop
[gitflow "prefix"]
  feature = feature/
  release = release/
  hotfix = hotfix/
  support = support/
  versiontag =
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/new_environment.sh">code/new_environment.sh</a></div></p>
</div>
<div class="title slide">
<h1>Postgres</h1>
</div>
<div class="slide"><h1>Why Postgres?</h1>
<ul>
	<li>Free, always will be</li>
	<li>Feature-rich (Larry Ellison rich)</li>
	<li>Full transaction support for <span class="caps">ALL</span> <span class="caps">DDL</span></li>
	<li>Extensions</li>
	<li>PostGIS</li>
	<li>Data-types (<span class="caps">JSON</span> now supported)</li>
	<li>Languages (heard of PL/V8?)</li>
	<li>Built-in async streaming replication</li>
	<li>Highly Extensible</li>
</ul>
</div>
<div class="slide"><h1>You can even&#8230;</h1>
<ul>
	<li>Query MySQL from Postgres:</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">hassan=: CREATE SERVER mysql_svr FOREIGN DATA WRAPPER mysql_fdw
         OPTIONS (address '127.0.0.1', port '3306');
CREATE SERVER
Time: 2.180 ms
hassan=: CREATE FOREIGN TABLE odp_projects (id INTEGER, name TEXT) SERVER mysql_svr OPTIONS
         (database 'odp_production', query 'SELECT id, name FROM odp_production.projects');
CREATE FOREIGN TABLE
Time: 2.823 ms
hassan=: CREATE USER MAPPING FOR PUBLIC SERVER mysql_svr OPTIONS (username 'hshahid', password 'xxxxxxxxxx');
CREATE USER MAPPING
Time: 1.679 ms
hassan=: EXPLAIN ANALYZE SELECT * FROM odp_projects LIMIT 10;                                                          QUERY PLAN                                                           
-------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..35.00 rows=10 width=36) (actual time=523.997..524.007 rows=10 loops=1)
   -&gt;  Foreign Scan on odp_projects  (cost=25.00..11466.00 rows=11441 width=36) (actual time=523.995..524.003 rows=10 loops=1)
         Remote server startup cost: 25
         MySQL query: SELECT id, name FROM odp_production.projects
 Total runtime: 667.406 ms
(5 rows)

Time: 857.613 ms
hassan=:
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/create.sql">code/sql/create.sql</a></div></p>
</div>
<div class="slide"><h1>A couple quick benchmarks</h1>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">dct83gqfeii39f=&gt; BEGIN;
dct83gqfeii39f=&gt; EXPLAIN ANALYZE SELECT generate_series(1,1000000,1);
                                         QUERY PLAN                                          
---------------------------------------------------------------------------------------------
 Result  (cost=0.00..0.00 rows=1 width=0) (actual time=0.008..1141.080 rows=1000000 loops=1)
 Total runtime: 2233.273 ms
(2 rows)
dct83gqfeii39f=&gt; EXPLAIN ANALYZE CREATE TABLE abc AS SELECT generate_series(1,1000000,1);
                                         QUERY PLAN                                          
                                        ---------------------------------------------------------------------------------------------
 Result  (cost=0.00..0.00 rows=1 width=0) (actual time=0.012..1577.464 rows=1000000 loops=1)
 Total runtime: 4458.538 ms
(2 rows)

Time: 4474.989 ms
dct83gqfeii39f=&gt; DROP TABLE abc;
DROP TABLE
Time: 29.822 ms
dct83gqfeii39f=&gt; CREATE TABLE abc AS SELECT generate_series(1,1000000,1);
SELECT 1000000
Time: 2306.769 ms
dct83gqfeii39f=&gt; ROLLBACK;

</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/benchmark.sql">code/sql/benchmark.sql</a></div></p>
</div>
<div class="slide"><h1>Data migration strategy</h1>
<ul>
	<li>moved from ruby to sql for schema_format</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">config.active_record.schema_format = :sql</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>have to use a couple different rake methods</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">rake db:structure:dump /* creates a structure.sql file */
rake db:structure:load</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>Change <span class="caps">VARCHAR</span> to <span class="caps">TEXT</span></li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">s/VARCHAR\(?\d*\)?/TEXT/g
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/regex.sh">code/regex.sh</a></div></p>
<ul>
	<li>We wanted to store every &#8220;database&#8221; in logically named schemas</li>
</ul>
</div>
<div class="slide"><h1>Data migration strategy (cont.)</h1>
<ul>
	<li>We also wanted a shared database between all the apps</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">$ heroku config:add DATABASE_URL=postgres://user:pass@host:port/dbname --remote &lt;remote_name&gt;
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/database_url.sh">code/database_url.sh</a></div></p>
<ul>
	<li>In case you didn&#8217;t know, DATABASE_URL is a concept heavily baked in ActiveRecord</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">initializer "active_record.initialize_database" do |app|
  ActiveSupport.on_load(:active_record) do
    db_connection_type = "DATABASE_URL"
    unless ENV['DATABASE_URL']
      db_connection_type  = "database.yml"
      self.configurations = app.config.database_configuration
    end
    Rails.logger.info "Connecting to database specified by #{db_connection_type}"

    establish_connection
  end
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/active_record/railtie.rb">code/active_record/railtie.rb</a></div></p>
</div>
<div class="slide"><h1>Data migration strategy (cont.)</h1>
<ul>
	<li>Unlike MySQL, Postgres doesn&#8217;t connect you to a &#8220;<span class="caps">SCHEMA</span>&#8221;</li>
	<li>database.yml config parameter to set schema path: schema_search_path</li>
	<li>Problem? ActiveRecord doesn&#8217;t support <span class="caps">URI</span> params on DATABASE_URL, and Heroku doesn&#8217;t support reading your database.yml file</li>
	<li>Gem: Heroku_db_env (we had to patch it)</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">class HerokuDbEnvRailtie &lt; Rails::Railtie
  initializer :initialize_heroku_db_env, {:group =&gt; :default, :before =&gt; "active_record.initialize_database"} do |app|
    db_config = HerokuDbEnv.build_db_config(app.config.database_configuration)

    ENV['DATABASE_URL'] = nil

    app.config.class_eval do
      define_method(:database_configuration) { db_config }
    end
  end
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/heroku_db_env.rb">code/heroku_db_env.rb</a></div></p>
</div>
<div class="slide"><h1>Data migration strategy (cont.)</h1>
<ul>
	<li>Taps gem.  Open-sourced by Heroku a while ago (had to patch it, also had to patch Sequel)</li>
</ul>
<p>- Run this on the source db server</p>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">$ taps server mysql://root@localhost/dbname?encoding=utf8 tmpuser tmppass
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/taps.sh">code/taps.sh</a></div></p>
<p>- Run this as a client</p>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">$ taps pull postgres://localhost/dbname?default_schema=schema_name http://tmpuser:tmppass@host:5000 -s schema_name
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/taps.sh">code/taps.sh</a></div></p>
</div>
<div class="slide"><h1>Quick tip</h1>
<ul>
	<li>On managing crazy incoherent Postgres connection strings</li>
	<li>Sample database url provided by heroku:<br />
  &#8211; postgres://asjf8hfwasdov:9824nms$02i@ec2-10-139-39-29.compute-1.amazonaws.com:5432/94jnas4n</li>
	<li>&#8230;</li>
	<li>Use pgpass files</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">$ echo host:port:dbname:user:pass &gt;&gt; ~/.pgpass &amp;&amp; chmod 600 ~/.pgpass
$ echo "alias pg_heroku='psql -d dbname -h host -U user'"
&gt;&gt; ~/.bash_profile</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Quick word on Heroku PG followers and forks</h1>
<ul>
	<li>Don&#8217;t scale up your Heroku web workers and run an ab -n 1000 -c 1000 host</li>
	<li>Heroku postgres gives you 500 concurrent connections</li>
	<li>Followers give you the ability to create master/slave setups, and hot-standbys</li>
	<li>Forks give you the ability to clone a snapshot of your DB</li>
	<li>Octopus gem is a good start to using active-record and master/slave or shard strategies</li>
</ul>
</div>
<div class="title slide">
<h1>Sphinx to Postgres <span class="caps">FTS</span>/Earthdistance</h1>
</div>
<div class="slide"><h1>Replacing Sphinx with Postgres <span class="caps">FTS</span></h1>
<ul>
	<li>Sphinx is awesome, but when you don&#8217;t need it, it&#8217;s overbearing</li>
	<li>A special version of Sphinx/ThinkingSphinx is available on Heroku (paid add-on)</li>
	<li>Building the Sphinx indices is a daily task</li>
	<li>Delta indices are cool, but super annoying</li>
	<li>Resque + Sphinx is a good way to manage delta indices, but adds complexity</li>
	<li>Basically, we need cron tasks, resque workers, Redis, Sphinx (on the same machine), and MySQL to use our trivial full-text-search</li>
	<li>Extending ThinkingSphinx is not fun (and Sphinx queries are not fun to write, especially when they&#8217;re abstracted by ThinkingSphinx)</li>
</ul>
</div>
<div class="slide"><h1>Enter Postgres <span class="caps">FTS</span></h1>
<ul>
	<li>Postgres supports full-text-search natively (tsearch2, pgtrm, etc&#8230;)</li>
	<li>supports stemming in multiple dictionaries</li>
	<li>GiST and <span class="caps">GIN</span> index types available for optimizing queries</li>
	<li>updating indices is on a row-by-row basis using triggers in real-time</li>
	<li>You can combine your full-text-search with any other <span class="caps">SQL</span> querying</li>
	<li>Pretty awesome performance</li>
</ul>
</div>
<div class="slide"><h1>Postgres <span class="caps">FTS</span> example</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT *
FROM table_name
WHERE ts_vector('english', column_name) @@
plainto_tsquery('english', 'text search');</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Replacing Sphinx spatial querying with Earthdistance</h1>
<ul>
	<li>Earthdistance is a Postgres extension that allows either querying using either a cube type (x, y and z points) or a point type (x and y points), where the earth is assumed to be perfectly spherical.</li>
	<li>I hope you&#8217;re not using Sphinx just for spatial queries :)</li>
</ul>
</div>
<div class="slide"><h1>Examples of earthdistance</h1>
<ul>
	<li>Cube example</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT * FROM table_name
WHERE earth_box(ll_to_earth(source_lat, source_lng), 5000) --kilometers
@&gt; ll_to_earth(lat_column, lng_column);
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/earthdistance.sql">code/sql/earthdistance.sql</a></div></p>
<ul>
	<li>Point example</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT * FROM table_name
WHERE (POINT(source_lat, source_lng) &lt;@&gt; POINT(lat_column, lng_column)) &lt;= 10;
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/earthdistance.sql">code/sql/earthdistance.sql</a></div></p>
<ul>
	<li>Sort by distance (<span class="caps">KNN</span>)</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT * FROM table_name
WHERE (POINT(source_lat, source_lng) &lt;@&gt; POINT(lat_column, lng_column)) &lt;= 10
ORDER BY POINT(lat_column, lng_column) &lt;-&gt; POINT(source_lat, source_lng);
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/earthdistance.sql">code/sql/earthdistance.sql</a></div></p>
</div>
<div class="title slide">
<h1>Our crazy non-<span class="caps">SSO</span> <span class="caps">SSO</span></h1>
</div>
<div class="slide"><h1>Our crazy non-<span class="caps">SSO</span> <span class="caps">SSO</span></h1>
<ul>
	<li>One of our biggest hurdles</li>
	<li>RubyCAS Server gem: doesn&#8217;t work on Read-Only FS</li>
	<li>Someone forked it and made it work for RO-FS, but it&#8217;s been unmaintained for ~ 2 years.</li>
	<li>Why are we even using this?! It doesn&#8217;t even offer us <span class="caps">SSO</span>!</li>
	<li>Each app now handles its own authentication, and the <span class="caps">API</span> was stripped out to still offer password-resets and account creation for backwards and mobile-app compatibility.</li>
</ul>
</div>
<div class="title slide">
<h1>Another horrible thing we had to deal with (Thanks consultants)</h1>
</div>
<div class="slide"><h1>Native mobile apps and asset handling</h1>
<ul>
	<li>Native mobile app had explicit resource <span class="caps">URI</span> prefixes hardcoded in iOS and Android code</li>
	<li>Storing photo uploads on application server.<br />
- e.g.: href=&#8220;/tag/v1/api/&#8221; + file_name</li>
	<li>Awesome.</li>
	<li>Heroku no like writing to application server.</li>
	<li>Had to migrate all the photos to s3, change their file names in the DB, and then download them from S3 from the application, and pass the resource to the mobile app. :(.</li>
	<li>Mad props to s3fs</li>
</ul>
</div>
<div class="title slide">
<h1>Cloudfront</h1>
</div>
<div class="slide"><h1>Cloudfront</h1>
<ul>
	<li>Don&#8217;t have access to Nginx/Apache configurations at Heroku</li>
	<li>Everything has to be done at the application level, meaning dynos are used<br />
to do things they shouldn&#8217;t be doing, so Rack::Cache isn&#8217;t a great solution.</li>
	<li>A strong solution to serving assets via a <span class="caps">CDN</span>.</li>
	<li>Cloudfront clones your assets, and any new asset that is served that Cloudfront doesn&#8217;t know about, it makes a request to your app and then caches it from then on.</li>
	<li>Wrote a simple custom middleware to return 404s on anything that wasn&#8217;t being served from /assets</li>
</ul>
</div>
<div class="slide"><h1>Cloudfront middleware code</h1>
<ul>
	<li>set the asset host in your environments/<env>.rb file</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">config.action_controller.asset_host = 'subdomain.cloudfront.net'</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>tell application.rb about your middleware</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">config.middleware.use "Kaboom::Cloudblock"</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>middleware code continued</h1>
<ul>
	<li>middleware code</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">module Kaboom
  class Cloudblock
    def initialize(app)
      @app = app 
    end 
    def call(env)
      if is_from_cloudfront?(env) &amp;&amp; !env['PATH_INFO'].match(/^\/assets/)
        [404, {}, ['Not found']]
      else
        @app.call(env)
      end 
    end 
    def is_from_cloudfront?(env)
      env['HTTP_USER_AGENT'] == 'Amazon CloudFront'
    end
  end 
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/cloudblock.rb">code/cloudblock.rb</a></div></p>
</div>
<div class="title slide">
<h1>Lessons Learned</h1>
</div>
<div class="slide"><h1>ActiveRecord, wtf?</h1>
<ul>
	<li>Schemas are not really supported (we&#8217;ll get back to this in a minute)<br />
  &#8211; Chicken or the egg problem</li>
</ul>
<ul>
	<li>Adapters return different result types unnecessarily</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">rows = ActiveRecord::Base.connection.execute(
  'SELECT id FROM users LIMIT 1'
)
rows.each do |row|
  puts "#{row}, #{row.class}"
end
MySQL: -&gt; 1, Array
Postgres: -&gt; {"id" =&gt; 1}, Hash
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/different_results.rb">code/different_results.rb</a></div></p>
</div>
<div class="slide"><h1>What&#8217;s wrong with this?</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">SCHEMA = 'custom_schema'

if !ActiveRecord::Base.connection.schema_exists?(SCHEMA)
  ActiveRecord::Base.connection.execute("CREATE SCHEMA #{SCHEMA}")
end

ActiveRecord::Base.connection.execute(
  "SET search_path = #{SCHEMA},public;"
)
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/schema_initializer.rb">code/schema_initializer.rb</a></div></p>
</div>
<div class="slide"><h1>Managing Web Server rewrites</h1>
<ul>
	<li>Where the hell do you do that?</li>
	<li>App, unfortunately</li>
	<li>Reasonable solution: Rack::Rewrite Gem (https://github.com/jtrupiano/rack-rewrite)</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do
  rewrite   '/wiki/John_Trupiano',  '/john'
  r301      '/wiki/Yair_Flicker',   '/yair'
  r302      '/wiki/Greg_Jastrab',   '/greg'
  r301      %r{/wiki/(\w+)_\w+},    '/$1'
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/rack_rewrite.rb">code/rack_rewrite.rb</a></div></p>
</div>
<div class="slide"><h1>Static websites on Heroku?</h1>
<ul>
	<li>Rack::Static.  Done.</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">use Rack::Static,
  :urls =&gt; ['/images', '/js/','/css', '/assets'],
  :root =&gt; 'public'

map '/index.html' do
  run lambda { |env|
    [   
      200,
      {   
        'Content-Type' =&gt; 'text/html'
      },  
      File.open('public/index.html', File::RDONLY)
    ]   
  }
end
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/rack_static.rb">code/rack_static.rb</a></div></p>
</div>
<div class="slide"><h1>PG_DUMP/Earthdistance, wtf?</h1>
<ul>
	<li>Earthdistance was written to be installed in the public schema</li>
	<li>Earthdistance was configured to only work if the public schema is in the search path</li>
	<li>Creating an index on a table using Earthdistance and running pg_dump DOESN&#8217;T <span class="caps">WORK</span>!!!</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">CREATE INDEX earthdistance_lat_lng_idx ON map.playspaces USING gist(LL_to_earth(lat,lng));</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Postgres 9.2, wtf?</h1>
<ul>
	<li>Made a really (stupid) unnecessary breaking change.<br />
- These work in &lt;= 9.1</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">CREATE LANGUAGE 'PLPGPSQL';
CREATE LANGUAGE PLPGSQL;
LANGUAGE 'SQL' IMMUTABLE;
LANGUAGE SQL STABLE;</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<p>- Only these work in &gt;= 9.2</p>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">CREATE LANGUAGE PLPGSQL;
LANGUAGE PLPGSQL VOLATILE;</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>MySQL, wtf?</h1>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">users = User.where('city = "Rockville"')</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">mysql&gt; CREATE TABLE abc (
        id INTEGER,
        name VARCHAR(255),
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP);
ERROR 1293 (HY000): Incorrect table definition; there can be only
one TIMESTAMP column with CURRENT_TIMESTAMP in
DEFAULT or ON UPDATE clause</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Pretty cool way of ordering with sets</h1>
<ul>
	<li>MySQL has a seemingly useful feature called FIND_IN_SET</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT * FROM badges ORDER BY FIND_IN_SET(id, '7,2,3');</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>Postgres doesn&#8217;t have this, initially looked at writing a function to replicate, then figured out that this is a totally useless function (at least for this purpose)</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">SELECT * FROM badges ORDER BY id IN (7, 2, 3);</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Heroku Postgres, wtf?</h1>
<ul>
	<li>9.2 is available on Heroku, but only as a devel-upgrade</li>
	<li>The only way to upgrade an add-on is if it&#8217;s attached to an app</li>
	<li>Starting off at the logical postgres.heroku.com to spin up a DB is wrong</li>
	<li>DB instances spun up through postgres.heroku.com aren&#8217;t considered apps, therefore not capable of upgrade</li>
	<li>Using pgbackups also doesn&#8217;t work as it&#8217;s looking for an app-specific DATABASE_URL</li>
	<li>The only way to do this if you have multiple apps is to add the postgres addon to the first app you create on Heroku, then upgrade that, and then use that DATABASE_URL as the DATABASE_URL for every other app.</li>
</ul>
</div>
<div class="slide"><h1>Heroku <span class="caps">SSL</span>, wtf?</h1>
<ul>
	<li>The <span class="caps">SSL</span> add-on is $20/month</li>
	<li>I have a wildcard-<span class="caps">SSL</span>, Heroku.  What should I do?</li>
	<li>Took a long time to understand through poor support knowledge, but once you understand, it&#8217;s very simple.</li>
	<li>Once you add the add-on to one of your apps, you receive a an <span class="caps">SSL</span> endpoint, which you need to create a <span class="caps">CNAME</span> record for all your sub-domains to that endpoint.</li>
	<li>It&#8217;s a little annoying that you place a universally used add-on arbitrarily on one of your apps.  One solution is to create a blank app to just manage addons like this.</li>
</ul>
</div>
<div class="slide"><h1>Heroku app names, wtf?</h1>
<ul>
	<li>If you plan on creating more than one app on Heroku, for the love of god, please name them something useful</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">new-host-4:~ hassan$ heroku apps
=== My Apps
ancient-beach-8895
damp-sierra-4743
guarded-ocean-5430
murmuring-taiga-5177
quiet-dawn-4309
rocky-sea-8976
safe-tor-4310
salty-temple-9045
shielded-savannah-5753
stormy-atoll-5345
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/heroku_apps.sh">code/heroku_apps.sh</a></div></p>
</div>
<div class="slide"><h1>Heroku, wtf?</h1>
<ul>
	<li>Not really Heroku, it&#8217;s a good enforcement</li>
	<li>Heroku has a soft request time-out at 30 seconds, and hard time-out at 60 seconds</li>
	<li>Things like multiple attachment uploads need to be re-evaluated.  We&#8217;re uploading images directly to s3 and using callbacks to process them with Paperclip.</li>
</ul>
</div>
<div class="slide"><h1>Heroku scheduler</h1>
<ul>
	<li>Heroku&#8217;s cron replacement</li>
	<li>Schedule things every 10 minutes, every hour, or every day</li>
	<li>So how do you schedule something to run every four hours? (Don&#8217;t spend 10 minutes on this like I did)</li>
</ul>
</div>
<div class="slide"><h1><span class="caps">ENV</span> Vars and config files w/ secrets/pw</h1>
<ul>
	<li>Heroku works entirely around Environment variables (not a bad thing)</li>
	<li>Remember, any file you want to Heroku to know about must be committed to the git repo.</li>
	<li>The better alternative to this is to use Heroku <span class="caps">ENV</span> vars</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">$ heroku config:add RACK_ENV=staging S3_ACCESS_ID=asj9s4b4s8fj
  S3_SECRET=ainbasf/3ja9sf --remote staging</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
</div>
<div class="slide"><h1>Pushing non-master branches to Heroku</h1>
<ul>
	<li>Most likely, you&#8217;re working on a development branch and not merging/pull-requesting it to master. (Please say yes).</li>
	<li>You&#8217;d think this would work if you want to see your changes deployed to Heroku:</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">$ git push heroku development</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>By now, you know this doesn&#8217;t work.  Try this:</li>
</ul>
<div class="code-normal">
<pre name="code" class="ruby:nogutter:nocontrols">$ git push heroku development:master</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku"></a></div></p>
<ul>
	<li>Nothing happened?  <span class="caps">WHY</span> :) ?</li>
</ul>
</div>
<div class="slide"><h1>Final lessons learned, promise.</h1>
<ul>
	<li>My two favorite Postgres features I&#8217;ve picked up in the last few months: <span class="caps">WITH</span>, and <span class="caps">LISTEN</span>/<span class="caps">NOTIFY</span></li>
	<li><span class="caps">WITH</span> allows you to write expressive, chainable <span class="caps">SQL</span></li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">WITH hassan_cards AS (
  SELECT id, member_ids FROM postrello.cards WHERE
  ARRAY[(SELECT id FROM postrello.members WHERE full_name = 'Hassan Shahid')] &lt;@ member_ids
), active_hassan_cards AS (
  SELECT id, member_ids FROM hassan_cards WHERE active IS TRUE
) SELECT id, member_ids FROM active_hassan_cards WHERE
  NOT ARRAY[(SELECT id FROM postrello.members WHERE full_name = 'Lukas Eklund')] &lt;@ member_ids;
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/with.sql">code/sql/with.sql</a></div></p>
<ul>
	<li><span class="caps">RECURSIVE</span> <span class="caps">FUN</span></li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">WITH RECURSIVE t(n) AS (
    VALUES (1) UNION ALL SELECT n+1 FROM t WHERE n &lt; 100
) SELECT sum(n) FROM t;
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/with.sql">code/sql/with.sql</a></div></p>
</div>
<div class="slide"><h1><span class="caps">LISTEN</span>/<span class="caps">NOTIFY</span></h1>
<ul>
	<li><span class="caps">LISTEN</span>/<span class="caps">NOTIFY</span> is <span class="caps">ASYNC</span> notifier with pub/sub, queue-building capabilities.  The PG gem implements this from libpq.</li>
</ul>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">1.9.3-p194 :001 &gt; conn = PG::Connection.connect({dbname: 'postrello_development'})
=&gt; &lt;PG::Connection:0x007f8f571b6bb8&gt;
1.9.3-p194 :002 &gt; conn.exec('LISTEN "test_trello"')
=&gt; &lt;PG::Result:0x007f8f571bfe70&gt;
1.9.3-p194 :003 &gt; conn.wait_for_notify do |event, pid, extra|
1.9.3-p194 :004 &gt;   puts "event: #{event}, pid: #{pid}, extra: #{extra}"
1.9.3-p194 :005?&gt; end
event: test_trello, pid: 66785, extra: hi
=&gt; "test_trello"
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/listen.rb">code/listen.rb</a></div></p>
<div class="code-tiny">
<pre name="code" class="ruby:nogutter:nocontrols">postrello_development=: NOTIFY "test_trello", 'hi';
NOTIFY
</pre><p></div><div class="codeurl"><a href="txmt://open?url=file:///Users/hassan/git_projects/presentations/kaboom_migration_to_heroku/code/sql/notify.sql">code/sql/notify.sql</a></div></p>
</div>
<div class="title slide">
<h1>Summarize this shiz</h1>
</div>
<div class="slide"><h1>Summarize this shiz</h1>
<ul>
	<li>The last few months have been extremely productive and eye-opening</li>
	<li>We focused on how we can be productive in all things we do</li>
	<li>Heroku has been a great decision for us; it allows us to focus on what we&#8217;re good at.</li>
	<li>Even as awesome as Heroku is, there are tons of things you have to watch out for.</li>
	<li>Postgres is awesome.</li>
	<li>We&#8217;re hiring.</li>
</ul>
</div>
<div class="title slide">
<h1>Any questions?</h1></div>
</div>

<!-- Syntax Highlighter -->
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shCore.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushCSharp.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushPhp.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushJScript.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushJava.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushVb.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushSql.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushXml.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushDelphi.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushPython.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushRuby.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushCss.js"></script>
<script class="javascript" src="../assets/dp.SyntaxHighlighter/Scripts/shBrushCpp.js"></script>
<script language="javascript">
dp.SyntaxHighlighter.ClipboardSwf = '/flash/clipboard.swf';
dp.SyntaxHighlighter.HighlightAll('code');
</script>
</body>
</html>
